# Performance Lab

JavaScript performance tests for Handsontable

## Install

The minimal Node version which this project can run on is 11. Make sure that your version meets that criteria before
you continue with the installation.

Install dependencies via [NPM](https://npmjs.com/)

```sh
$ npm install
```

Test results are stored in MongoDB instance so it is necessary to set up the DB before you run the script. If you have
[docker](https://www.docker.com/) installed you can run services using [docker-compose](https://github.com/docker/compose).

```sh
docker-compose -f docker/docker-compose.yml up
```

## Run It

To run performance tests and save the results to the DB execute

```sh
$ ./bin/hot-perf run
```

or

```sh
$ npm run start
```

Performance tests are defined in the `test/spec` directory. Each test contains code which prepares Handsontable for tests
and block of code which then executes several times (defined as SAMPLE_SIZE in the `lib/config.js` file). After each
call, stats are collected and after the amount of iteration hit the SAMPLE_SIZE the result is saved to the database.

Once completed you can view generated test reports by running `./bin/hot-perf local-server benchmark-viewer`.
It serves a page where you can compare your generated results between different Handsontable versions and different test cases.

## Usage

##### ```> ./bin/hot-perf run```

It runs a benchmark by running all spec files defined in the `test/spec` directory. Once completed results are saved to the database.

##### ```> ./bin/hot-perf local-server <app_to_serve>```

Runs a local server.

Arguments:
- ```test-runner``` - It serves a test runner page which is used by protractor to test the Handsontable.
- ```benchmark-viewer``` - It serves a page which is used to view results generated by the `run` command.

### Global options:
- ```--hot-version``` - Selects version of the Handsontable to test (it has to be a version which is accessible through [jsdelivr](https://www.jsdelivr.com/)). If not specified the `latest` tag is used. For example `--hot-version=6.2.2`.
- ```--hot-server``` - Selects a server to be used to serve the Handsontable assets. For example `--hot-server=http://localhost:8082`. If
used the assets are loaded from `dist` directory, such as `http://localhost:8082/dist/handsontable.full.css`.

## License

[MIT License](https://opensource.org/licenses/MIT)
